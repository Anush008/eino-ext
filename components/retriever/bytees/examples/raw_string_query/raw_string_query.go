package main

import (
	"context"

	"code.byted.org/flow/eino-ext/components/retriever/bytees"
	"code.byted.org/gopkg/logs"
	"code.byted.org/lang/gg/gptr"
)

func main() {
	ctx := context.Background()
	cfg := &bytees.RetrieverConfig{
		PSM:            "byte.es.knntest_boe",
		Cluster:        "data",
		Index:          "eino_app_es_knn_test_2",
		TopK:           5,
		ScoreThreshold: gptr.Of(0.1),
		SearchMode:     bytees.SearchModeRawStringQuery,
	}

	ret, err := bytees.NewRetriever(ctx, cfg)
	if err != nil {
		logs.CtxError(ctx, "NewRetriever failed, %v", err)
		return
	}

	rawMatch(ctx, ret)

	rawKNN(ctx, ret)
}

func rawMatch(ctx context.Context, r *bytees.Retriever) {
	// use match query
	query := `
{
    "match": {
        "eino_doc_content": {
            "query": "中国"
        }
    }
}`

	docs, err := r.Retrieve(ctx, query)
	if err != nil {
		logs.CtxError(ctx, "bytees Retrieve failed, %v", err)
		return
	}

	logs.CtxInfo(ctx, "bytees Retrieve success, result: %v", docs)

	for i, doc := range docs {
		// extra non-content fields by GetExtraDataFields
		ext, ok := bytees.GetExtraDataFields(doc)
		if !ok {
			logs.CtxWarn(ctx, "docs[%d] extra fields not found", i)
		} else {
			logs.CtxInfo(ctx, "docs[%d] extra fields=%+v", i, ext)
		}
	}
}

func rawKNN(ctx context.Context, r *bytees.Retriever) {
	/* use knn query, see: https://cloud.bytedance.net/docs/ses/docs/6614e634c6a2250303cdeb04/6630ae80a4561c02e780c33f
	 * query schema like below
		{
		    "knn": {
		        "vector_eino_doc_content": {
		            "vector": [
		                0.07823245227336884,
		                0.006584686227142811,
						... 1022 items
		            ],
		            "k": 2
		        }
		    }
		}
	*/

	query := "{\"knn\":{\"vector_eino_doc_content\":{\"vector\":[-0.03747574985027313,0.07823245227336884,0.006584686227142811,0.000737074704375118,0.015620972029864788,-0.009751714766025543,0.014837188646197319,0.03831421583890915,-0.004285742063075304,-0.08063848316669464,-0.0791802778840065,0.10243857651948929,-0.0370747447013855,-0.03959013894200325,-0.003928027115762234,-0.022310465574264526,0.02076112851500511,-0.04932362958788872,0.06445245444774628,0.008781100623309612,0.0006476460257545114,-0.021708957850933075,0.0012531409738585353,0.03404897823929787,-0.040938977152109146,0.009697032161056995,0.02675797790288925,0.04017341881990433,-0.0300207007676363,0.004249286837875843,0.014326818287372589,0.019485201686620712,0.0702488049864769,-0.03275482729077339,-0.007979090325534344,0.11723931133747101,0.08464853465557098,0.0034677828662097454,0.03618159517645836,0.019284699112176895,0.03087739273905754,-0.07684715837240219,0.026940252631902695,0.04476675018668175,-0.002756910165771842,-0.009136537089943886,-0.024935226887464523,-0.07371202856302261,-0.0033310765866190195,0.008051999844610691,-0.044292837381362915,-0.05205775424838066,0.03282773494720459,-0.008266173303127289,0.0052540781907737255,-0.0014764278894290328,-0.00035230349749326706,0.08537763357162476,-0.012686342932283878,0.014326818287372589,-0.012504068203270435,-0.016978921368718147,-0.04298045486211777,0.028015675023198128,0.03375734016299248,0.04195971414446831,0.026885569095611572,0.011419531889259815,0.00851680152118206,-0.013105575926601887,0.012285337783396244,0.03342924267053604,0.044839661568403244,-0.02746884897351265,0.04691759869456291,0.022018825635313988,-0.0077102347277104855,0.06448891013860703,0.017307015135884285,-0.012677229940891266,0.018993059173226357,0.011155232787132263,0.012403816916048527,-0.034686941653490067,-0.05584907531738281,0.025281548500061035,-0.027450622990727425,-0.06543674319982529,-0.00022727419855073094,0.0166234839707613,0.01866496540606022,-0.0018068014178425074,-0.040975429117679596,-0.006798859219998121,0.03696538135409355,-0.021162133663892746,0.025445597246289253,0.026174696162343025,-0.005618628114461899,0.058619655668735504,-0.002800200367346406,-0.061681877821683884,-0.02628406137228012,-0.011209915392100811,0.029528558254241943,0.038970403373241425,0.026466336101293564,0.014053406193852425,-0.019448747858405113,-0.07440467178821564,0.02019607461988926,-0.03091384842991829,0.05027145892381668,0.01063574943691492,-0.026338744908571243,0.05289622023701668,0.0000673919275868684,0.020050255581736565,-0.0050626895390450954,-0.025117501616477966,-0.06361398845911026,-0.08800239115953445,-0.0018592055421322584,-0.04115770757198334,0.020597079768776894,0.012458499521017075,-0.02899996004998684,-0.022474512457847595,0.0032239898573607206,0.027450622990727425,0.016295388340950012,0.05253166705369949,0.019667478278279305,0.025536734610795975,0.04906844347715378,0.0030736129265278578,-0.01709739863872528,0.025700781494379044,-0.013980495743453503,-0.03352038189768791,-0.041704531759023666,0.006128998473286629,-0.06292134523391724,-0.041267070919275284,-0.06736885756254196,-0.045860402286052704,0.02003202773630619,-0.02670329436659813,-0.0497610867023468,-0.0028753888327628374,0.01866496540606022,0.022930201143026352,-0.03390315920114517,0.027833400294184685,-0.022602105513215065,-0.012932414188981056,-0.061937060207128525,0.029182234779000282,0.0039303055964410305,-0.007218091748654842,0.010198288597166538,-0.01815459504723549,0.018829012289643288,0.02207350917160511,0.03973596170544624,-0.049688179045915604,0.0421784445643425,-0.04622495174407959,-0.03656437620520592,0.034723397344350815,-0.08187795430421829,-0.003069056198000908,-0.025081045925617218,-0.03441352769732475,-0.015639198943972588,0.015721222385764122,0.013433670625090599,-0.02376866526901722,0.005149269942194223,0.021873006597161293,0.04418347030878067,0.023677527904510498,0.01539312768727541,0.014509093947708607,-0.07626388221979141,-0.004290299024432898,-0.013734424486756325,-0.00013592306640930474,-0.013342533260583878,0.03973596170544624,-0.05380759388208389,0.007017589174211025,0.07068626582622528,-0.040975429117679596,0.015256421640515327,-0.06423372775316238,0.006265704985707998,-0.009305140934884548,0.03209863603115082,0.0029118438251316547,0.017334356904029846,0.011237256228923798,-0.03583527356386185,-0.004379157908260822,-0.029054641723632812,0.005267749074846506,0.01223065610975027,-0.028890594840049744,0.007295558694750071,0.014299477450549603,0.027924537658691406,0.012321793474256992,-0.014053406193852425,0.02797921933233738,-0.006502662319689989,0.059603940695524216,0.020633535459637642,0.025919511914253235,0.021034540608525276,0.02781517244875431,0.02581014670431614,-0.01092738937586546,0.016614370048046112,0.00866262149065733,-0.050198547542095184,0.007131511345505714,0.016322730109095573,0.02105276845395565,0.011301052756607533,0.009368937462568283,0.01686955615878105,-0.0433814600110054,-0.034249480813741684,-0.014436183497309685,0.007537072990089655,0.001649589161388576,0.022383375093340874,-0.040246330201625824,-0.009282357059419155,-0.007477833889424801,0.015894385054707527,0.007591755595058203,-0.019813297316432,0.030512843281030655,0.016605256125330925,-0.012832162901759148,-0.010526384226977825,0.024351947009563446,0.08187795430421829,0.022893745452165604,0.03465048596262932,-0.0044042207300662994,-0.009236788377165794,-0.01760776899755001,0.02121681533753872,-0.0065619018860161304,0.04921426251530647,0.02032366767525673,-0.0015857928665354848,0.0027796945068985224,0.018938377499580383,0.04462093114852905,-0.021508455276489258,-0.005358886439353228,0.006170010194182396,-0.00035258830757811666,-0.023823348805308342,0.02143554575741291,0.0006601774366572499,0.013889358378946781,-0.014509093947708607,-0.00779225816950202,0.04104834049940109,0.055776163935661316,-0.005791789852082729,0.030330568552017212,0.013615946285426617,-0.01295064203441143,0.004771049600094557,-0.010590179823338985,0.017279675230383873,-0.05916647985577583,-0.03598109260201454,0.04265236109495163,-0.05789055675268173,0.050672464072704315,-0.008658064529299736,0.04236071929335594,-0.007477833889424801,0.06919160485267639,-0.046589501202106476,-0.034942127764225006,0.013998723588883877,-0.014955667778849602,-0.01505591906607151,0.03787675499916077,-0.0216907300055027,0.01411720272153616,-0.060369495302438736,-0.05260457843542099,-0.03980886936187744,0.0014980729902163148,-0.016404753550887108,-0.01935761049389839,-0.002090466907247901,0.007842384278774261,0.0370747447013855,-0.007076828740537167,-0.04392828792333603,0.01078156940639019,0.03053107112646103,-0.03798611834645271,-0.04360019043087959,-0.01856471411883831,-0.03929850086569786,0.008817555382847786,-0.02781517244875431,-0.007281888276338577,-0.00012474448885768652,-0.053989868611097336,-0.02960146777331829,-0.010116265155375004,-0.010909161530435085,-0.0765555202960968,-0.023331206291913986,0.03754866123199463,0.010571952909231186,-0.027578214183449745,0.06306716799736023,0.00496699521318078,0.03049461543560028,-0.0664939358830452,-0.03295532986521721,0.032299138605594635,0.033228740096092224,0.0028890594840049744,-0.007737575564533472,-0.01728878915309906,0.030986757948994637,-0.010544611141085625,-0.025846602395176888,0.00794263556599617,0.023950941860675812,-0.0018341427203267813,0.029328055679798126,-0.028799457475543022,0.06915515661239624,-0.008617052808403969,0.07524313777685165,-0.019539885222911835,0.000550812401343137,-0.009460074827075005,-0.011620034463703632,-0.00794263556599617,0.0652180090546608,-0.044037651270627975,0.020141392946243286,-0.03988178074359894,0.004356373567134142,0.0031852563843131065,0.028507817536592484,-0.03288241848349571,-0.014700482599437237,0.03443175554275513,0.019740387797355652,0.07538896054029465,0.048667438328266144,0.03747574985027313,-0.06270261853933334,0.004329032264649868,-0.010644862428307533,-0.018145481124520302,-0.06722303479909897,0.02925514429807663,-0.0433814600110054,-0.03355683758854866,-0.02147200144827366,-0.016067545861005783,0.03490567207336426,-0.03988178074359894,-0.01706094481050968,-0.08829403668642044,-0.011401304043829441,0.026138242334127426,-0.043308552354574203,0.014381500892341137,0.06835314631462097,-0.10440714657306671,-0.0268308874219656,0.016978921368718147,-0.012103063054382801,-0.023659301921725273,-0.03805902972817421,0.012786594219505787,0.00902717188000679,-0.03665551170706749,0.02577369101345539,-0.04389183223247528,-0.000297336169751361,-0.02220110036432743,-0.05945812165737152,0.026685066521167755,0.016550574451684952,0.054317962378263474,-0.006516332738101482,-0.025664325803518295,0.015265535563230515,0.05949457734823227,-0.022474512457847595,0.005231293849647045,-0.015110601671040058,-0.06146314740180969,0.0008840339723974466,0.03831421583890915,0.04104834049940109,0.026484563946723938,0.00870819017291069,-0.023422343656420708,-0.03375734016299248,-0.026010649278759956,-0.0020095824729651213,0.05034436658024788,-0.030421705916523933,0.03224445506930351,-0.05406277999281883,0.07123308628797531,-0.02577369101345539,-0.0029847538098692894,0.00586925633251667,-0.048375796526670456,0.01569388248026371,-0.009131980128586292,-0.00898160319775343,0.02172718569636345,0.03100498579442501,-0.009081854484975338,0.005185725167393684,-0.037694480270147324,0.03751220554113388,0.005295089911669493,-0.030348794534802437,-0.006903667468577623,0.026083558797836304,-0.0023057793732732534,-0.03824130445718765,0.03645500913262367,0.012804822064936161,-0.04524066671729088,0.0011118777329102159,0.0332469679415226,-0.00886768102645874,-0.0018489524954929948,-0.03362974524497986,-0.025737237185239792,0.009961331263184547,-0.014855416491627693,-0.07254546880722046,-0.005595843773335218,0.04957881197333336,-0.03249964118003845,0.08027393370866776,0.021636048331856728,0.012385589070618153,-0.05923939123749733,0.015903497114777565,0.00937805138528347,-0.044511567801237106,0.036509692668914795,0.018774330615997314,0.002989310771226883,-0.02730480208992958,-0.013041779398918152,0.009145650081336498,0.05216711759567261,-0.05799992009997368,-0.05008918419480324,-0.005345215555280447,-0.04440220072865486,-0.028398452326655388,0.033155832439661026,0.0017487012082710862,-0.0020152784418314695,0.017534859478473663,-0.013679741881787777,0.03632741793990135,0.009615008719265461,-0.0003477466234471649,0.017844727262854576,-0.014964781701564789,0.005696095060557127,0.039991144090890884,0.0006880883011035621,0.027031389996409416,-0.021399090066552162,-0.051474474370479584,-0.08997096121311188,0.03685601428151131,-0.026721522212028503,-0.038678765296936035,0.03547072410583496,-0.028781229630112648,0.0485580712556839,0.054536692798137665,-0.03162471950054169,-0.05953102931380272,-0.010909161530435085,0.00743226520717144,0.010262085124850273,-0.01365240104496479,-0.012531409971415997,-0.009423620067536831,-0.02223755605518818,0.008612495847046375,-0.01853737235069275,0.012722798623144627,0.01875610277056694,0.002690835390239954,0.0036455008666962385,-0.021781867370009422,-0.008986160159111023,0.012494954280555248,-0.01892014965415001,-0.009551212191581726,-0.027487076818943024,0.011948129162192345,-0.02066999115049839,-0.024060307070612907,0.011428645811975002,0.016614370048046112,-0.014153657481074333,0.025026364251971245,0.0383506715297699,0.007733019068837166,0.029419193044304848,0.02581014670431614,-0.0027364040724933147,-0.029455646872520447,-0.018382439389824867,-0.039152681827545166,-0.0369289256632328,-0.05049018934369087,-0.025719009339809418,-0.019813297316432,-0.01601286232471466,0.004388271830976009,-0.02998424507677555,-0.013041779398918152,-0.04524066671729088,-0.03350215405225754,0.012084835208952427,-0.007386696524918079,-0.010708658955991268,-0.006639368832111359,-0.024844089522957802,-0.010526384226977825,-0.016131341457366943,0.00600596284493804,-0.019977346062660217,-0.03368442878127098,0.022784380242228508,0.03457757830619812,-0.03475985303521156,-0.004436118993908167,-0.021544910967350006,0.012987096793949604,0.020979857072234154,0.0331740602850914,-0.017106512561440468,-0.04527712240815163,-0.002606533234938979,-0.02529977634549141,0.00354524957947433,-0.026593929156661034,-0.0063796266913414,0.02909109741449356,-0.045568760484457016,-0.007856054231524467,-0.03379379212856293,0.04061087965965271,-0.03078625537455082,-0.02564609982073307,0.007154295686632395,0.0027204551734030247,0.012668116018176079,0.030695118010044098,0.023914486169815063,-0.017079172655940056,-0.05038082227110863,-0.031697630882263184,-0.0020460374653339386,0.03583527356386185,0.03563477098941803,0.01486453041434288,-0.0035885400138795376,0.016960693523287773,-0.01639563962817192,0.01539312768727541,-0.020177848637104034,-0.008316298946738243,0.0034199354704469442,0.05953102931380272,0.015602744184434414,-0.0006687215645797551,-0.0028708321042358875,-0.01186610572040081,0.005591287277638912,0.06693139672279358,-0.03457757830619812,0.02070644497871399,0.05038082227110863,-0.05719790980219841,0.04370955750346184,-0.018719647079706192,-0.0027409610338509083,-0.0002577482955530286,0.033155832439661026,0.008061113767325878,0.06390563398599625,-0.014427069574594498,-0.0268308874219656,0.03614514321088791,-0.028908822685480118,0.07079562544822693,-0.0293462835252285,0.008553256280720234,-0.025081045925617218,0.01808168552815914,0.011784082278609276,-0.01741638034582138,-0.011027640663087368,-0.002613368444144726,-0.012166859582066536,-0.03583527356386185,-0.03506971895694733,0.007003918755799532,0.05260457843542099,-0.030093610286712646,0.0460062213242054,0.0017395875183865428,0.03623627871274948,0.005299646873027086,-0.04822997748851776,-0.006324944086372852,-0.02861718274652958,-0.011510669253766537,-0.07633679360151291,0.0033470254857093096,0.05227648466825485,-0.017124740406870842,0.01566654071211815,0.008776543661952019,0.039152681827545166,0.010371450334787369,0.011856991797685623,-0.00158921058755368,-0.003242217469960451,0.0020711002871394157,-0.03537958487868309,0.01601286232471466,0.03448643907904625,0.020469488576054573,0.005331545136868954,-0.01505591906607151,0.011893446557223797,-0.015356672927737236,0.00549559248611331,-0.033155832439661026,-0.0357259102165699,-0.003702461952343583,0.014527320861816406,0.0037252462934702635,-0.03805902972817421,-0.01182053703814745,0.006388740614056587,-0.013707083649933338,-0.0184644628316164,0.02504459209740162,-0.04421992599964142,-0.03669196739792824,0.03342924267053604,0.019412292167544365,-0.03911622613668442,-0.0092322314158082,-0.03543426841497421,-0.01569388248026371,-0.0011654210975393653,-0.010234744288027287,0.017270561307668686,0.018391551449894905,0.008366424590349197,-0.008794770576059818,-0.02216464653611183,-0.020104937255382538,-0.07021234929561615,-0.005030791275203228,-0.01930292695760727,0.024989908561110497,0.04702696204185486,-0.019667478278279305,-0.0261929240077734,-0.02746884897351265,-0.02985665202140808,-0.03512440249323845,0.04392828792333603,-0.004962438251823187,0.024716496467590332,-0.010216516442596912,0.010936503298580647,-0.0446573868393898,-0.02041480503976345,0.01314203068614006,0.011282825842499733,0.055557433515787125,0.021617820486426353,-0.017589541152119637,0.022638561204075813,0.029419193044304848,-0.0016997148049995303,-0.0008293514838442206,0.011565351858735085,0.024643586948513985,0.008931477554142475,-0.037147656083106995,-0.06456182152032852,0.00622013583779335,-0.0060424176044762135,-0.007136068306863308,0.010125379078090191,-0.01875610277056694,-0.0015516163548454642,-0.03237204998731613,0.014445297420024872,0.02500813640654087,0.01449998002499342,-0.024825861677527428,0.033064693212509155,-0.030476387590169907,-0.010480815544724464,-0.004486244637519121,-0.01897483319044113,-0.0045454842038452625,-0.019321154803037643,-0.02568255364894867,-0.012257996946573257,0.003707018680870533,0.018683193251490593,-0.0043609305284917355,-0.019594566896557808,0.04852161929011345,-0.013360761106014252,-0.06485345959663391,-0.009008944034576416,-0.0008464397396892309,-0.046589501202106476,-0.0017270561074838042,0.05267748981714249,-0.04746442288160324,0.05001627281308174,0.003392594400793314,0.03173408657312393,-0.01566654071211815,0.04954235628247261,-0.010681318119168282,0.06828023493289948,-0.010016013868153095,-0.012002811767160892,-0.0076464382000267506,0.003928027115762234,-0.009063626639544964,-0.00008366139809368178,-0.0022784380707889795,0.023713983595371246,-0.0028958949260413647,0.022857291623950005,-0.041740987449884415,0.008320855908095837,0.027122527360916138,0.03218977153301239,-0.04425638169050217,0.021070996299386024,0.0665668472647667,0.007154295686632395,-0.012285337783396244,-0.03506971895694733,-0.007869725115597248,-0.014828074723482132,-0.06758758425712585,0.06849896162748337,-0.030312340706586838,0.019959118217229843,0.021526683121919632,0.01751663163304329,0.03534313291311264,-0.003928027115762234,-0.039225589483976364,0.00692189484834671,0.04400119557976723,0.00221350253559649,0.012704570777714252,-0.00794263556599617,0.019977346062660217,-0.003638665657490492,0.014946553856134415,-0.01990443468093872,0.013898472301661968,0.013934927061200142,0.029820198193192482,-0.01467314176261425,-0.0055092633701860905,0.018510030582547188,0.014809847809374332,0.03630919009447098,0.01046258769929409,-0.010198288597166538,0.006507219281047583,0.011064095422625542,-0.0007336570415645838,-0.009587667882442474,-0.00889957882463932,0.021399090066552162,0.007445935625582933,-0.02513572946190834,-0.018263960257172585,0.030895620584487915,-0.059603940695524216,0.0184644628316164,0.004306247923523188,0.014618459157645702,-0.028416680172085762,0.02006848342716694,0.000282241526292637,-0.008024659007787704,-0.010717772878706455,0.04957881197333336,0.022346921265125275,0.0070677148178219795,-0.033921387046575546,0.04771960899233818,0.026648612692952156,0.005231293849647045,-0.019631022587418556,0.007801372092217207,0.020633535459637642,-0.017853841185569763,0.02325829677283764,0.030458159744739532,-0.01009803730994463,-0.027760488912463188,-0.014536434784531593,0.041485801339149475,0.005960394162684679,0.04928717389702797,0.024607131257653236,-0.014290363527834415,-0.03871522098779678,0.002051733434200287,0.008658064529299736,-0.0034153787419199944,-0.01416277140378952,-0.011036754585802555,0.011747626587748528,0.03228091076016426,0.0016518676420673728,-0.03652792051434517,0.02657570131123066,-0.019102424383163452,0.009797283448278904,0.02772403508424759,-0.02066999115049839,0.021836550906300545,0.007919850759208202,-0.031898133456707,-0.05610426142811775,0.0007518845959566534,0.016477664932608604,0.04669886827468872,0.010726886801421642,-0.004003215581178665,-0.0004858769243583083,-0.034887444227933884,-0.043818920850753784,0.021617820486426353,0.007122397422790527,0.00622013583779335,-0.07801371812820435,0.014900985173881054,-0.04753733053803444,0.019631022587418556,-0.005873813293874264,-0.06405144929885864,-0.018592054024338722,-0.041485801339149475,-0.01543869636952877,-0.017334356904029846,0.022565651684999466,0.020888719707727432,-0.05136510729789734,-0.019321154803037643,-0.002556407591328025,-0.012668116018176079,-0.021453773602843285,-0.0021246434189379215,-0.011720285750925541,-0.040209874510765076,-0.005500149447470903,0.009797283448278904,0.011811423115432262,0.002961969468742609,-0.005395341198891401,0.025864828377962112,-0.000560210959520191,-0.0600414015352726,0.018428007140755653,-0.0675511360168457,0.012558750808238983,-0.017944978550076485,-0.005049018654972315,0.04192326217889786,0.0004542635870166123,0.0051219286397099495,0.0005755904130637646,-0.01713385432958603,0.05457314848899841,0.028945278376340866,-0.04491257295012474,-0.048084158450365067,0.025755465030670166,0.014536434784531593,-0.004538648761808872,-0.002918679267168045,-0.013934927061200142,-0.008594268932938576,0.0009392860811203718,0.011902560479938984,0.024443084374070168,0.04268881678581238,-0.038897495716810226,-0.017498403787612915,0.05001627281308174,0.016213364899158478,0.043016910552978516,-0.08333615213632584,-0.013524808920919895,-0.01328785065561533,-0.03712942823767662,-0.042032625526189804,0.014773393049836159,0.05727082118391991,-0.010061582550406456,-0.017307015135884285,-0.047646697610616684,0.00833908375352621,-0.04677177593111992,0.03423125296831131,0.04119415953755379,-0.004153592512011528,-0.04502193629741669,0.016951579600572586,-0.01847357675433159,0.021162133663892746,0.04932362958788872,0.024552449584007263,-0.014891871251165867,0.009072740562260151,0.031114351004362106,-0.018045229837298393,-0.010180061683058739,0.010152719914913177,0.023659301921725273,0.029273372143507004,-0.0027500747237354517,-0.005632298998534679,-0.021034540608525276,0.02641165442764759,0.04104834049940109,0.0037662582471966743,-0.006110771093517542,0.009214003570377827,-0.024315491318702698,-0.052240028977394104,-0.0037822071462869644,0.05078182741999626,0.030585752800107002,-0.015484265051782131,0.021508455276489258,-0.006279375404119492,-0.014919213019311428,-0.04119415953755379,0.04367310181260109,0.009724373929202557,0.003351582447066903,0.017252333462238312,0.016732849180698395,-0.08362779021263123,0.024734724313020706,0.03568945452570915,-0.021909460425376892,0.024005623534321785,-0.03403075039386749,0.052969127893447876,-0.020341895520687103,-0.018619395792484283,-0.019193561747670174,0.000134997462737374,0.02415144443511963,-0.021544910967350006,-0.04906844347715378,0.03900685906410217,0.001095928717404604,-0.013424557633697987,0.019703932106494904,0.09113752096891403,0.008402879349887371,0.006940122228115797,0.03218977153301239,-0.009669691324234009,-0.057088546454906464,0.014144543558359146,-0.011282825842499733,0.06095277518033981,-0.0034723395947366953,0.020469488576054573,-0.043527282774448395,-0.01917533576488495],\"k\":2}}}"

	docs, err := r.Retrieve(ctx, query)
	if err != nil {
		logs.CtxError(ctx, "bytees Retrieve failed, %v", err)
		return
	}

	logs.CtxInfo(ctx, "bytees Retrieve success, result: %v", docs)

	for i, doc := range docs {
		// extra non-content fields by GetExtraDataFields
		ext, ok := bytees.GetExtraDataFields(doc)
		if !ok {
			logs.CtxWarn(ctx, "docs[%d] extra fields not found", i)
		} else {
			logs.CtxInfo(ctx, "docs[%d] extra fields=%+v", i, ext)
		}
	}
}
